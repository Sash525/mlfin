###  Model data
class catboost_model(object):
    float_features_index = [
        13, 16, 29, 30, 40, 60, 72, 93, 96, 106, 111, 112, 114, 120, 121, 130, 133, 139, 241, 283, 343, 344, 350, 364, 372, 398, 419, 438, 440, 444, 454, 473, 488, 498, 503, 516, 532, 567, 595, 603, 604, 605, 608, 620, 632, 648, 652, 654, 661, 670, 674, 700, 711, 719, 728, 739, 743, 754, 768, 775, 801, 803, 840, 872, 880, 886, 906, 912, 924, 935, 937, 939, 941, 946, 948, 951, 955, 960, 966, 969, 990, 991, 993, 994, 998, 1005,
    ]
    float_feature_count = 1013
    cat_feature_count = 0
    binary_feature_count = 86
    tree_count = 15
    float_feature_borders = [
        [5.86999989],
        [4.95050001],
        [-2.65600014],
        [-1.31500006],
        [0.252499998],
        [4.18050003],
        [-4.39400005],
        [-3.78550005],
        [-3.13999987],
        [9.82699966],
        [7.07600021],
        [5.32750034],
        [1.72900009],
        [4.17650032],
        [9.08699989],
        [10.3444996],
        [0.595499992],
        [7.22049999],
        [0.5],
        [0.5],
        [-0.727345228],
        [0.343779743],
        [0.716773808],
        [0.258077383],
        [0.252592266],
        [0.242416665],
        [0.664586306],
        [0.585422635],
        [-1.07899404],
        [-0.616755962],
        [0.486630976],
        [0.571916699],
        [0.162145823],
        [-0.48391369],
        [-0.939625025, -0.864785671],
        [-19.1704998],
        [-17.6450005],
        [-20.1774998],
        [-18.1315002],
        [-18.573],
        [-20.6555004],
        [-19.2724991],
        [-21.8859997, -19.4685001],
        [-25.6364994],
        [-23.9475002],
        [-18.5094986],
        [-22.2314987],
        [-19.5089989],
        [-24.0760002],
        [-22.3579998],
        [-23.1264992],
        [24.3894997],
        [21.0579987],
        [16.8920002],
        [17.5419998],
        [16.7950001],
        [16.948],
        [17.6549988],
        [18.7945004],
        [17.8419991, 24.3894997],
        [21.3424988],
        [16.3785],
        [16.8364983, 21.1404991],
        [7.3513217],
        [8.00570202],
        [7.1765523],
        [7.11677456],
        [7.324193],
        [7.26650763],
        [7.74911022],
        [7.06630182],
        [8.38948536],
        [7.17136335],
        [6.95720243],
        [6.96612167],
        [7.12919426],
        [7.97656441],
        [7.52814102],
        [7.48986006],
        [7.50174999],
        [6.53481102],
        [9.18102551],
        [7.64731646],
        [7.99331522],
        [7.43207169],
        [7.74237204],
    ]
    tree_depth = [6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6]
    tree_split_border = [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
    tree_split_feature_index = [68, 43, 6, 28, 53, 52, 78, 76, 75, 25, 32, 24, 77, 37, 58, 56, 4, 62, 84, 39, 27, 31, 42, 65, 83, 48, 70, 80, 5, 63, 79, 59, 33, 36, 15, 22, 66, 40, 21, 23, 34, 59, 54, 50, 67, 61, 17, 11, 73, 44, 38, 20, 12, 1, 82, 41, 85, 19, 13, 7, 69, 30, 49, 3, 14, 45, 51, 74, 8, 29, 16, 34, 46, 81, 42, 47, 60, 9, 72, 0, 18, 71, 35, 57, 55, 10, 64, 26, 62, 2]
    tree_split_xor_mask = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
    cat_features_index = []
    one_hot_cat_feature_index = []
    one_hot_hash_values = [
    ]
    ctr_feature_borders = [
    ]

    ## Aggregated array of leaf values for trees. Each tree is represented by a separate line:
    leaf_values = [
        0, 0.0721841831576046, -0.07030835453068097, 0.05426678246351596, 0, -0.03881383207081163, -0.02380124390937819, 0.01167894928733663, 0, -0.04437609990782242, -0.0130648171341754, -0.006305775649334451, 0, 0, -0.01075485494963028, -0.003579534522331074, 0, 0, 0.003463381288131131, -0.002512361063229041, 0, 0.01936319575237297, -0.006519894047216944, 0.006411046102668489, 0, 0.02525715030611725, -0.003971747136038629, 0.003399740668257546, 0, 0.01874753745617364, -0.009109104384413608, 0.003808705582808624, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -0.04334217569938828, 0.03881383207081159, 0, 0, -0.02590108064946012, -0.03247378743850481, 0, 0, -0.04414420605529101, 0.007853536942031392, 0, 0, -0.01070079334357503, 0.02483909661261393, 0, 0.01274439360979837, -0.02807329610249129, 0.004806528904549788, 0, 0.01871086333103313, -0.005485247887202934, 0.01167897196015984,
        -0.01515866098634138, 0.0006729341314850257, 0, 0, -0.003661756275610109, 0.007911199261001313, 0, 0.01047178996620262, -0.01924157961318893, 0, 0, 0, -0.01414667249567808, 0.01941933528416291, 0, 0.01590355223683637, -0.01214799581829875, -0.1515554580003337, 0, 0, 0.01151526458466557, -0.003131539170648822, 0, 0.005533637838898917, -0.001388108660169555, 0, 0, 0, 0.006450047072883359, 0.007291545375931905, 0, 0.01737961126194253, 0.002658901012957038, 0, 0, 0, -0.0007786144734072351, 0.01128575346366866, 0, 0.01624114887401837, 0.00238260875922835, 0, 0, 0, -0.01059979127268875, 0.0102206140279998, 0, 0.0103414874385496, -0.004841620423078822, 0.0004585981698232386, 0, 0, 0.002457962892796472, -0.01667174583880091, 0, 0.02953930294309995, -0.01075420301830655, 0, 0, 0, -0.02449867039822563, 0.009298834428874997, 0, 0.01167011588152886,
        -0.02210439700268239, -0.005207517587215888, -0.01543435565006455, -0.005560225033900091, -0.05553506626791754, 0.04245227621673835, 0.01390125503746814, 0, 0.009802962341966927, 0.005242983764617217, -0.00880298659591934, -0.002280086125165475, -0.04463051353596854, 0.00488879798880407, 0.004377914499786271, 0.01555303180583601, 0.007474468935359267, -0.01416459685242822, -0.01581717388043152, -0.04466280862022499, 0.016076984200063, 0.04243366607460716, 0.02400585074985273, 0, -0.002984684925968597, 0.006731240149351235, -0.01050547066601757, -0.0022504239367974, 0.01530161843499842, 0.007669600364695588, 0.004127352266903355, -0.006728239105960088, 0.02590914407466622, 0.05320889446833909, 0.008293911192312708, 0, -0.07151597044563179, -0.02356131803158852, 0.02091057063056886, 0, 0.008757969282531006, 0.01752994461769301, -0.009998161119132608, 0.01921967987881731, -0.02012568236521311, 0.01149470636666535, -0.01317115234050542, 0.009786558503437549, -0.02829383152088348, -0.01501044245585972, -0.01869989014496716, 0, 0.0833279143005307, -0.09527183330048147, 0.008019746734413661, 0, -0.02295993881450917, 0.01002987372850476, -0.01993649168195411, 0.02246838450942821, -0.002687355659839741, 0.01486839521887537, -0.01158098813842995, 0.002994651126581754,
        -0.00869833545201297, 0.00389972525539934, 0.05324495952179194, -0.06856428765579854, -0.02059278474119215, 0.03519939869817943, 0.08270418962350776, 0, -0.0168312742481955, 0.04606177207064818, 0.1665285720267599, 0, -0.04495499359096662, 0.007963872289487762, 0, 0, -0.01905072062603429, -0.03071765055829029, -0.006283028507171035, -0.01185097671496216, -0.05902711566108561, 0.09707266526041365, 0.003065852562419622, -0.03660052227155967, -0.01306739272823083, 0, -0.0008889349141225917, 0.006747519163821362, -0.008164902275031858, 0, -0.02448927835338687, -0.07311496324741373, -0.001357776661313911, 0.009009126661897727, 0.02689041711770402, -0.001161229392453892, -0.004498932394196718, -0.005341051491084438, 0, 0.1161658962989483, 0.0003762957567951366, 0.01452539158340698, -0.01062772267327349, 0, -0.02904032324753526, 0.009489470196747099, 0.001342250683636535, 0.1758147127499665, 0.0224576755206328, 0.01276752984485128, 0.0004501141784532241, -0.002424222711944441, -0.01860912922516176, 0.02284225178226049, -0.02659513714415573, 0.02609711485021989, 0.03052040642861177, -0.01369765327303384, 0.006674885413353814, 0.009345859508857255, -0.04140118199947123, 0.04456006725600443, -0.01513084600540984, 0.008989299812239684,
        0, 0, 0.0009338038286528358, 0, 0, 0, 0.001169619869908318, 0, 0, 0, -0.0121240808384728, -0.1514204503079671, 0, 0, 0.001738699450539685, -8.890648801650474e-06, 0, 0, -0.009796767941431004, 0, 0, 0, -0.1071422868277194, 0, 0, 0, -0.009033859522281969, 0.07231385190631667, 0, 0, -0.002621825412127117, -0.03706614603101063, 0, 0, -0.001306874825853676, 0, 0, 0, -0.03999807619262265, 0, 0, 0, -0.004934621893033107, 0.001495636158994969, 0.01454878636521262, 0.01015040460812373, 0.006138794027997858, 0.008402323348952374, 0, 0, -0.02095522979872141, 0, 0, 0, -0.1052130072622871, 0, 0, 0, -0.003122803253610079, 0.0009457366124840907, -0.00572098686594732, 0.01470643271550638, -0.005233878390108457, 0.01046720782237695,
        -0.008935519618346361, 0.005702173460968025, 0, 0.003309070291661745, -0.005704412082459265, 0.002916245205283705, -0.02849662357302721, 0.0144131437120803, -0.007780086680136534, 0.02086017542562081, -0.004753364995974185, 0.02675135745205495, -0.00292525986077307, -0.00287393213757997, 0.01322037251967833, 0.04869515957327757, 0.02545467059206709, 0.02474802788595531, 0, 0.06229146133345193, -0.02430125052380327, 0.003273380499042258, -0.06285588649345222, 0.003453644714867072, -0.00404150374307811, 0.05353901832507758, 0.0003259286902331402, -0.1119842411997987, -0.003654724080601826, 0.07242540576300509, 0.04060552950074125, -0.002518917113142243, -0.01777691326253526, 0.02078136485542935, 0, -0.04189663497447101, 0.003932769682908064, 0.01373790345067273, -0.02429418102105046, 0.01474576632623381, -0.1246353458408277, 0.04865475315124545, 0.0003869034947850582, 0, -0.008309565627378173, -0.02516662754546053, 0.04599730836395561, 0.01042080028812087, 0.04396164583500816, -0.008619460815240778, 0, -0.002663065012220951, -0.02519697479203762, 0.003342038857624412, 0.03827751876932501, 0.05283435326957493, 0, 0.1075046772733623, 0.0717940362880829, 0, -0.0208056038231194, 0.04099494330977247, 0, -0.02860148221733224,
        -0.03734623585732796, -0.002556535867873091, -0.01196352975595929, -0.06253227396710009, -0.04163200717664198, 0.1351017451031355, -0.06556638057051092, -0.03690658159386462, -0.07207343329957225, 0.004252763202280034, -0.02821306249213364, 0.1357933443057072, -0.04248738386849845, -0.02847972445310599, 0.07385120574052445, 0, 0.006808697547883651, -1.128971517082623e-05, -0.01143279558620831, -0.00199647805270078, -0.03615854314887076, -0.02225639769942772, -0.01683447198370985, 0.01580727587505641, -0.09954806871348985, 0.01640993980706735, -0.01428263921681647, 0.001078079355593642, -0.01619333978042068, 0.006271551301879938, 0.001841680105720211, 0.01895016524307929, -0.009243487848857743, 0.007222540525945252, 0.01446863196210584, -0.01068946651919275, 0, 0.01210286608534618, -0.032908094908848, -0.05730565796844882, 0, -0.01870826230371625, 0.1153468121409742, -0.1342266688560346, 0, 0.0416807853117294, 0.06016194480240974, -0.04340374778620918, -0.02409681380236538, 0.004904508189062691, -0.00577053625430677, 0.004615047179312904, -0.01189465744687191, 0.01553907686049995, -0.001030176608085501, 0.03676588669398505, -0.01396779060231583, 0.02035999983530061, -0.01470197116061622, 0.006580990310042062, -0.00775154491424809, 0.006543018869031035, -0.001351253896592134, 0.003735269880900249,
        -0.02692350227526089, 0, -0.00897949651118273, -0.008596842679209021, 0.04515296400692066, -0.04181205094920549, -0.02783915971639952, 0.06365315555753889, -0.001191183870988649, 0.1094303737578732, -0.01145504631260752, -0.001990407824187976, -0.0122257385887638, 0.003764824434712323, -0.00479470402576403, 0.001674978091178962, 0.07287750238565691, 0, 0.001740538114027349, -0.02700199158327891, 0.0353246040891412, 0, -0.01876721353133841, 0.03477554163619571, -0.02247254580373959, 0, 0.003558056396484042, -0.005391557806046554, 0.009832808994551427, 0.02099353531918145, -0.03137517358768246, 6.673222586438448e-05, -0.0368070262192609, 0, 0.0009253420806358304, 0.02513598340736718, 0.02614447539185835, 0, 0.002966715973336512, 0.01380634264029369, 0.04600008856310456, 0, -0.01527220738582284, -0.01101722234972005, 0.00353322286692465, 0.01728166708661259, 0.0005770137983286432, 0.006360866782342728, 0, 0, 0.02057508596906657, 0.008876155949530357, -0.002816632466840905, 0, -0.07072658092764172, 0.05705802105178209, 0, 0, -0.01184155612911303, 0.01697382638250047, -0.003980775221277448, 0.02607101119125083, 0.02115407550194327, 0.02203116385418188,
        0, 0.01408615212820456, -0.004034808892827631, 0.001848920816784262, 0, 0, -0.01209199415910366, 0.01586000866137502, -0.0705347616227408, 0.006222435566473046, -0.01181643170911496, 0.007021860694959566, 0, -0.08590266838533384, -0.006793281022492951, 0.002195095341031148, 0, 0.002442220921092192, -0.02280905501608866, 0.009677881981577164, 0, 0, -0.008429148129941043, -0.02437628477736839, 0, 0.02015527850140959, -0.006637339585545095, -0.004525599332968422, 0, 0.06615321424158456, -0.004561524478957958, 0.007452315534615178, 0, 0.003754796555667147, -0.002418648257841363, 0.001323418432533325, 0, 0, 0.00414537699675255, 0.06435204609356247, 0, -0.0012353838277208, -0.01429305919596177, 0.007301249620978166, 0, 0.0718632390345656, 0.006144220949819492, -0.006904332438176649, 0, -0.03592531300664208, -0.05671756046746466, 0.004589854747303719, 0, 0, 0.01288417569247096, -0.08591543503216853, 0.07317841575327005, 0.005566343194947224, -0.0314915132076642, 0.004518663605528985, 0, 0.06134069142811837, -0.01421332739179896, 0.002595980070043315,
        -0.00160087608974388, -0.01032056964289042, -0.001161024368458064, 0.02332946866283857, -0.09884209309357357, 0.01454240528513078, 0.04292972971543633, -0.002955797377719016, -0.007415547450449661, 0.03538400161084482, -0.006259578182094631, -0.05967883002894767, -0.06475289001597169, 0.002775000837859946, -0.06000128242285633, 0.008561435244294662, -0.01671854633593986, -0.04708131732130209, -0.01176968781198857, 0.01678980873676501, -0.00182530249728475, 0.00025258439056866, -0.0002329407728632965, -0.01649612741955238, 0.004561263505045633, 0.003485852323214305, -0.01342618131277151, -0.09833144754580544, -0.0842299832433762, 0.005582813228423819, 0.07022188985763207, -0.0139925158622191, -0.002176663162103893, 0.01333801461898173, -0.007903119081902695, -0.01323724258754385, 0.02437981585287028, 0.01189164454191854, 0.01701272266402207, 0.01526723327699131, -0.008774359943604792, 0.02827394754979039, -0.002876061701153012, 0.02034980403504554, -0.01699832901938245, 0.00550148860973994, -0.009652124918615786, 0.00413053906455097, -0.008655043844060024, -0.0233679380263036, 0.002167855779411194, -0.05774444318149299, -0.001625186951710856, 0.01946852490433664, 0.148406502472109, 0.0002434186107417071, -0.005318526348812351, 0.002284524140255926, 0.003449783598721813, -0.001645136196938192, -0.01288672744309231, -0.003939439585490767, 0, 0.001423157233864499,
        0.01819748377031518, 0.007347528854014691, 0, 0.001091322891265595, -0.007822506935366218, 0.008647680778187502, -0.007372763827219307, -0.001655252883191917, 0.01106394922491638, 0.004459070637427824, 0, 0.01654802873944677, -0.0004171914422789804, 0.01236654827502683, -0.0001059083763003072, -0.01367632340969728, -0.007159446049133799, 0.00462579842413071, 0, 0.02731982821737911, 0.01784835340619505, -0.0017749255699127, -0.01511705574101937, -0.03471566801107443, 0.03488436035483283, 0.01338353213601971, 0, 0.03686623271385931, -0.00265839378275578, -0.02402207614724104, -0.0393850141826347, 0.0006563757151921417, -0.06012041579499735, 0.1202070166195665, 0, 0.003551156425917132, -0.003107811829936113, 0.001151372753405557, -0.02342169012622406, -0.001561228819537367, -0.05406539197654837, -0.08638548159660761, 0, 0.02474813778824915, -0.004867929896274568, 0.005612789725299614, -0.008777971561815303, 0.0165977189048434, 0.0003742442741374547, 0, 0, 0.01968294266478363, 0.007552214206796022, -0.01087933105887834, -0.004125938795292139, 0.02353118056488459, 0.137217160808232, 0, 0, 0.1063743738766075, -0.00610645140461685, -0.024772606339043, 0.0006527652361392663, 0.005909212541194402,
        -0.003937276660382599, 0, 0.004656406008774638, 0.02310979376225207, -0.01684892609965781, 0, -0.000658244974164413, 0.008173947332459399, -0.02221889310748944, 0, 0.00674570356927964, 0.005776386119494043, -0.002209801506871966, 0, -0.00853924048807073, 0.02512700496270552, -0.1192828235890725, 0, 0.002511041984554871, -0.1195504397517772, 0.01256175378948727, 0, -0.001638897199044506, -0.01172797601262094, 0.03573226319893141, 0, 0.01956262488399934, 0.03875460613392923, 0.02021778474737137, 0, 0.0001158307868189418, 0.009625269147682256, -0.0358356325648941, 0, 0.007353436133686984, -0.003031439812412817, 0.0007755549341131461, 0.07329690671295547, 0.008302270741197116, 0.03756673518065007, -0.005618518565976399, 0.06775982802870252, 0.006719482497493221, 0.006594535044793476, -0.004527749361371864, 0.07681695183490536, -0.0014601265494632, 0.01872189634919267, -0.03700854359418546, 0, 0.004579708937771836, -0.0213785773022473, -0.0274245385756572, 0, 0.003434184994739427, 0.008130926594987969, -0.003461613124860424, -0.05292594204000099, 0.00345160434892331, 0.01106062978414002, -0.007915498779174876, -0.001008827782209521, 0.0005945784067708883, 0.003624588150769518,
        0.005258802334591225, -0.009659849184081836, -0.006078910710574428, 0, 0.01576957360589816, -0.0007539956067585248, 0, 0.06878765069063525, 0.02192914506131095, -0.006260925134805725, 0, 0, 0, -0.00489688463144626, 0, 0, 0.008542569808465877, 0.001511482778772067, 0.0127608630502701, 0, 0.01299079522807868, 0.002565100643743237, 0.0003918971798686496, 0.02525315068000284, 0.06365616602808422, -0.004552471643236617, 0, 0, 0, 0.002531501565427828, 0, 0, 0.01195475884788813, -0.01789374738931216, -0.03085245782217683, 0, -0.008807378521828677, 0.01369840972856705, 0, 0, -0.07497624092953913, -0.03011831876482777, 0, 0, 0, 0.0004105492945071889, 0, 0, 0.0175696230505104, 0.01581347039996004, -0.04117658854906945, 0, -0.02596795069117721, -0.01223192117184379, -0.06962233802550591, 0.02048793783844657, 0.07013614142752346, 0.003894922866785109, 0, 0, 0, 0.002602197450819635, 0, 0,
        -0.001602586337066833, -0.0128212862324533, 0.008709627702235986, -0.01303425597328421, -0.01682635376191823, 0.007255930581907372, -0.02551174380729059, -0.01640922200229233, 0, 0.007505862974744758, 0, 0.02630992194349397, 0, -0.0157655842541436, 0, 0.02725897486899067, -0.005872144020477427, 0.005187726071458949, 0.0008657694204498897, -0.009514608753256723, -0.01226935765725199, -0.0008215367569994749, 6.606812834798056e-05, -0.04154567415446868, 0, -0.003924003197853939, 0, -0.004066628190475137, 0, 0.05926777595772664, 0, -0.1131950981480905, -0.02934321479219294, 0.002295588708612182, 0.01112722754237454, 0.01464782681055601, 0.01221319620455921, 0.0006562712362609733, 0.004175599813040312, -0.001243212024065566, 0, 0.01011921102452683, 0, 0.007852684697538153, 0, 0.009088164430727581, 0, -0.01608133354874519, -0.004147749110662818, 0.01647901360279319, 0.002450958944503721, -0.003684117269706003, -0.002054018596820316, 0.008869253207655801, 0.006975194810999317, -0.01201306456795088, 0, 0.01354542550292268, 0, 0.02916655668849815, 0, -0.007601922287095598, 0, -0.01817940619819256,
        -0.01565567834115142, -0.009544887214436611, 0.03801356518993673, 0.009896020880544728, 0, 0.04407570132293807, 0, 0.1054863644432259, 0.02028818454269385, -0.01556481213439845, -0.03372216467214405, 0.08356751927347321, 0, 0.07229306767185495, 0, 0.07327564902997583, -0.009261799426720507, -0.004601474979223042, 0.02553393101556106, 0.0008748674127130946, 0.03380707492183551, 0.002498189548431413, 0, 0.002368268231636749, -0.01935195700005178, -0.005453720788171501, -0.017632065081184, -0.01197086869016015, 0, -0.006700048521655291, 0, 0.0100263615069277, -0.01426035253930107, 0.002176756535040254, 0.01466711598205421, -0.0004884714534720014, 0, -0.06475005365165599, 0, 0.08147206601547434, -0.0226105648154905, 0.02348729043965185, 0.04319271687987699, -0.02837834395880685, 0, 0.0253887635621429, 0, 0.07246798938566654, -0.008692357438102333, 0.001260804960830435, -0.00688062030891072, -0.004580363832496641, -0.0420622106038008, 0.006598468138033627, 0.1073187863216189, 0.02254143392196888, -0.01892341533526757, 0.006073810514607454, -0.01937510624938989, -0.02158190899818666, 0, -0.004115668985917063, 0, 0.01263441876359407
    ]
    scale = 1
    bias = 0
cat_features_hashes = {
}

def hash_uint64(string):
    return cat_features_hashes.get(str(string), 0x7fFFffFF)


### Applicator for the CatBoost model

def apply_catboost_model(float_features, cat_features=[], ntree_start=0, ntree_end=catboost_model.tree_count):
    """
    Applies the model built by CatBoost.

    Parameters
    ----------

    float_features : list of float features

    cat_features : list of categorical features
        You need to pass float and categorical features separately in the same order they appeared in train dataset.
        For example if you had features f1,f2,f3,f4, where f2 and f4 were considered categorical, you need to pass here float_features=f1,f3, cat_features=f2,f4


    Returns
    -------
    prediction : formula value for the model and the features

    """
    if ntree_end == 0:
        ntree_end = catboost_model.tree_count
    else:
        ntree_end = min(ntree_end, catboost_model.tree_count)

    model = catboost_model

    assert len(float_features) >= model.float_feature_count
    assert len(cat_features) >= model.cat_feature_count

    # Binarise features
    binary_features = [0] * model.binary_feature_count
    binary_feature_index = 0

    for i in range(len(model.float_feature_borders)):
        for border in model.float_feature_borders[i]:
            binary_features[binary_feature_index] += 1 if (float_features[model.float_features_index[i]] > border) else 0
        binary_feature_index += 1
    transposed_hash = [0] * model.cat_feature_count
    for i in range(model.cat_feature_count):
        transposed_hash[i] = hash_uint64(cat_features[i])

    if len(model.one_hot_cat_feature_index) > 0:
        cat_feature_packed_indexes = {}
        for i in range(model.cat_feature_count):
            cat_feature_packed_indexes[model.cat_features_index[i]] = i
        for i in range(len(model.one_hot_cat_feature_index)):
            cat_idx = cat_feature_packed_indexes[model.one_hot_cat_feature_index[i]]
            hash = transposed_hash[cat_idx]
            for border_idx in range(len(model.one_hot_hash_values[i])):
                binary_features[binary_feature_index] |= (1 if hash == model.one_hot_hash_values[i][border_idx] else 0) * (border_idx + 1)
            binary_feature_index += 1

    if hasattr(model, 'model_ctrs') and model.model_ctrs.used_model_ctrs_count > 0:
        ctrs = [0.] * model.model_ctrs.used_model_ctrs_count;
        calc_ctrs(model.model_ctrs, binary_features, transposed_hash, ctrs)
        for i in range(len(model.ctr_feature_borders)):
            for border in model.ctr_feature_borders[i]:
                binary_features[binary_feature_index] += 1 if ctrs[i] > border else 0
            binary_feature_index += 1

    # Extract and sum values from trees
    result = 0.
    tree_splits_index = 0
    current_tree_leaf_values_index = 0
    for tree_id in range(ntree_start, ntree_end):
        current_tree_depth = model.tree_depth[tree_id]
        index = 0
        for depth in range(current_tree_depth):
            border_val = model.tree_split_border[tree_splits_index + depth]
            feature_index = model.tree_split_feature_index[tree_splits_index + depth]
            xor_mask = model.tree_split_xor_mask[tree_splits_index + depth]
            index |= ((binary_features[feature_index] ^ xor_mask) >= border_val) << depth
        result += model.leaf_values[current_tree_leaf_values_index + index]
        tree_splits_index += current_tree_depth
        current_tree_leaf_values_index += (1 << current_tree_depth)
    return model.scale * result + model.bias



